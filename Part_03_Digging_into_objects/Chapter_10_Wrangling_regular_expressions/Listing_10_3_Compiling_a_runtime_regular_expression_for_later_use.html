<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Listing 10.3 - Compiling a runtime regular expression for later use</title>
    <!-- CSS -->
    <link rel="stylesheet" href="Common_Things/styles.css" />
    <!-- Javascript -->
    <script src="Common_Things/common_functions.js"></script>
  </head>
  <body>
    <!-- Creates test subjects of various elements with various class names -->
    <div class="samurai ninja"></div>
    <div class="ninja samurai"></div>
    <div></div>
    <span class="samurai ninja ronin"></span>

    <ul id="results"></ul>

    <!-- Javascript -->
    <script>
      function findClassInElements(className, type) {
        // Collects elements by type
        const elems = document.getElementsByTagName(type || '*');

        // Compiles a regex using the passed class name
        const regex = new RegExp('(^|\\s)' + className + '(\\s|$)');

        // Stores the results
        const results = [];
        for (let i = 0; i < elems.length; i++) {
          const element = elems[i];
          if (regex.test(element.className)) {
            results.push(element);
          }
        }

        return results;
      }

      assert(
        findClassInElements('ninja', 'div').length === 2,
        'The right amount of div ninjas was found'
      );
      assert(
        findClassInElements('ninja', 'span').length === 1,
        'The right amoutn of span ninjas was found.'
      );
      assert(findClassInElements('ninja').length === 3, 'The right amount of ninjas was found.');
    </script>
  </body>
</html>
